# WIKI: https://wiki.metacubex.one/config/

dns: {enable: true, ipv6: false, prefer-h3: true, listen: "0.0.0.0:53", enhanced-mode: fake-ip, fake-ip-range: "198.18.0.1/16", nameserver: ["tls://1.1.1.1", "tls://8.8.8.8", "https://dns.cloudflare.com/dns-query", "https://dns.google/dns-query"], default-nameserver: ["system://", "223.5.5.5"], nameserver-policy: {geosite:cn: ["system://", "223.5.5.5"]}, fake-ip-filter: ["+.lan", "+.local", "+.example.com"]}

# 代理集合（获取机场订阅链接内的所有节点）
proxy-providers:
  🛫 aggregator:
    # 源地址 https://github.com/wzdnzd/aggregator
    url: "https://ghproxy.net/https://gist.githubusercontent.com/zwyzcdn/98bf1db8aaf0576e94871cce25b885e5/raw/clash.yaml"
    type: http
    interval: 3600
    health-check:
      enable: true
      lazy: true
      url: "https://www.gstatic.com/generate_204"
      interval: 600

#  🛫 WARP:
#    # 源地址 https://github.com/vvbbnn00/WARP-Clash-API
#    url: "https://subs.zeabur.app/clash"
#    filter: "(?i)CF|WARP"

  🛫 Vless:
    url: "https://publicvless.pages.dev/d17ca95a-8eaf-492f-93fa-538c88956bb3"
    type: http
    interval: 3600
    health-check:
      enable: true
      lazy: true
      url: "https://www.gstatic.com/generate_204"
      interval: 600

  🛫 我的机场 1:
    # 源地址 https://github.com/aiboboxx/clashfree
    url: "https://cdn.jsdelivr.net/gh/aiboboxx/clashfree@main/clash.yml"
    type: http
    interval: 3600
    health-check:
      enable: true
      lazy: true
      url: "https://www.gstatic.com/generate_204"
      interval: 600

  🛫 我的机场 2:
    # 源地址 https://github.com/ermaozi/get_subscribe
    url: "https://cdn.jsdelivr.net/gh/ermaozi/get_subscribe@main/subscribe/clash.yml"
    type: http
    interval: 3600
    health-check:
      enable: true
      lazy: true
      url: "https://www.gstatic.com/generate_204"
      interval: 600

  # 更多免费订阅收集仓库: https://github.com/WilliamStar007/ClashX-V2Ray-TopFreeProxy

# 策略组
proxy-groups:
  - {name: 🚀 节点选择, type: select, proxies: [🌏 aggregator, 🇺🇸 美国节点, 🇺🇳 其它节点, 🆓 Vless节点, 🎯 全球直连]}
  - {name: 🌏 aggregator, type: url-test, lazy: true, use: [🛫 aggregator]}
#  - {name: 🌏 WARP, type: url-test, lazy: true, use: [🛫 WARP]}
  - {name: 🆓 Vless节点, type: url-test, lazy: true, use: [🛫 Vless]}
  - {name: 🏫 ZJU, type: select, proxies: [🎯 全球直连]}
  - {name: 🤖 AI, type: select, proxies: [🆓 Vless节点]}
  - {name: ♾️ GitHub, type: select, proxies: [🚀 节点选择, 🎯 全球直连]}
  - {name: 📢 谷歌服务, type: select, proxies: [🚀 节点选择, 🎯 全球直连]}
  - {name: Ⓜ️ 微软服务, type: select, proxies: [🎯 全球直连, 🚀 节点选择]}
  - {name: 🍎 苹果服务, type: select, proxies: [🎯 全球直连, 🚀 节点选择]}
  - {name: 🎮 游戏平台, type: select, proxies: [🎯 全球直连, 🚀 节点选择]}
  - {name: 🔗 直连域名, type: select, proxies: [🎯 全球直连, 🚀 节点选择]}
  - {name: 🇨🇳 国内 IP, type: select, proxies: [🎯 全球直连, 🚀 节点选择]}
  - {name: 🪜 代理域名, type: select, proxies: [🚀 节点选择, 🎯 全球直连]}
  - {name: 📲 电报消息, type: select, proxies: [🚀 节点选择]}
  - {name: 🐟 漏网之鱼, type: select, proxies: [🚀 节点选择, 🎯 全球直连]}
  - {name: 📈 网络测速, type: select, proxies: [🎯 全球直连, 🚀 节点选择]}
  - {name: 🔒 私有网络, type: select, proxies: [DIRECT]}
  - {name: 🛑 广告拦截, type: select, proxies: [REJECT]}
  - {name: 🎯 全球直连, type: select, proxies: [DIRECT]}

  - {name: 🇺🇸 美国节点, type: url-test, lazy: true, use: [🛫 我的机场 1, 🛫 我的机场 2], filter: "(?i)美|us|unitedstates|united states"}
  - {name: 🇺🇳 其它节点, type: url-test, lazy: true, use: [🛫 我的机场 1, 🛫 我的机场 2], filter: "^(?!.*(?i)(CloudFlare|CF|WARP|美|us)).*$"}

# 路由规则
rules:
  - RULE-SET,zju,🏫 ZJU
  - RULE-SET,ai,🤖 AI

  - RULE-SET,applications,DIRECT

  - GEOSITE,category-ads-all,🛑 广告拦截
  - DST-PORT,6881-6889,🎯 全球直连   # P2P(BT)流量端口
  - GEOSITE,private,🔒 私有网络
  - GEOSITE,github,♾️ GitHub
  - GEOSITE,microsoft,Ⓜ️ 微软服务
  - GEOSITE,apple,🍎 苹果服务
  - GEOSITE,google,📢 谷歌服务
  - GEOSITE,category-games@cn,🎮 游戏平台
  - GEOSITE,speedtest,📈 网络测速
  - GEOSITE,geolocation-!cn,🪜 代理域名
  - GEOSITE,cn,🔗 直连域名
  - GEOIP,telegram,📲 电报消息,no-resolve
  - GEOIP,private,🔒 私有网络,no-resolve
  - GEOIP,cn,🇨🇳 国内 IP
  - MATCH,🐟 漏网之鱼

# 规则集（yaml 文件每天自动更新）
rule-providers:
  zju:
    type: http
    behavior: classical
    format: yaml
    path: ./rules/ZJU.yaml
    url: "https://fastly.jsdelivr.net/gh/MadisonWirtanen/WARP-Clash-with-ZJU-Rules@main/ZJU.yaml"
    interval: 86400

  ai:
    type: http
    behavior: classical
    format: yaml
    path: ./rules/ai.yaml
    url: "https://fastly.jsdelivr.net/gh/MadisonWirtanen/WARP-Clash-with-ZJU-Rules@main/ai.yaml"
    interval: 86400

  applications:
    type: http
    behavior: classical
    format: yaml
    path: ./rules/applications.yaml
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"
    interval: 86400
